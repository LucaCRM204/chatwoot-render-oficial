{"version":3,"file":"HelpCenterLayout-Bu_Qq_7a.js","sources":["../../../app/javascript/dashboard/components-next/HelpCenter/PortalSwitcher/PortalSwitcher.vue","../../../app/javascript/dashboard/components-next/HelpCenter/HelpCenterLayout.vue"],"sourcesContent":["<script setup>\r\nimport { computed } from 'vue';\r\nimport { useI18n } from 'vue-i18n';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { useMapGetter, useStore } from 'dashboard/composables/store.js';\r\nimport { buildPortalURL } from 'dashboard/helper/portalHelper';\r\n\r\nimport Button from 'dashboard/components-next/button/Button.vue';\r\nimport Avatar from 'dashboard/components-next/avatar/Avatar.vue';\r\n\r\nconst emit = defineEmits(['close', 'createPortal']);\r\n\r\nconst { t } = useI18n();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst store = useStore();\r\n\r\nconst DEFAULT_ROUTE = 'portals_articles_index';\r\nconst CATEGORY_ROUTE = 'portals_categories_index';\r\nconst CATEGORY_SUB_ROUTES = [\r\n  'portals_categories_articles_index',\r\n  'portals_categories_articles_edit',\r\n];\r\n\r\nconst portals = useMapGetter('portals/allPortals');\r\n\r\nconst currentPortalSlug = computed(() => route.params.portalSlug);\r\n\r\nconst portalLink = computed(() => {\r\n  return buildPortalURL(currentPortalSlug.value);\r\n});\r\n\r\nconst isPortalActive = portal => {\r\n  return portal.slug === currentPortalSlug.value;\r\n};\r\n\r\nconst getPortalThumbnailSrc = portal => {\r\n  return portal?.logo?.file_url || '';\r\n};\r\n\r\nconst fetchPortalAndItsCategories = async (slug, locale) => {\r\n  await store.dispatch('portals/switchPortal', true);\r\n  await store.dispatch('portals/index');\r\n  const selectedPortalParam = {\r\n    portalSlug: slug,\r\n    locale,\r\n  };\r\n  await store.dispatch('portals/show', selectedPortalParam);\r\n  await store.dispatch('categories/index', selectedPortalParam);\r\n  await store.dispatch('agents/get');\r\n  await store.dispatch('portals/switchPortal', false);\r\n};\r\n\r\nconst handlePortalChange = async portal => {\r\n  if (isPortalActive(portal)) return;\r\n  const {\r\n    slug,\r\n    meta: { default_locale: defaultLocale },\r\n  } = portal;\r\n  emit('close');\r\n  await fetchPortalAndItsCategories(slug, defaultLocale);\r\n  const targetRouteName = CATEGORY_SUB_ROUTES.includes(route.name)\r\n    ? CATEGORY_ROUTE\r\n    : route.name || DEFAULT_ROUTE;\r\n  router.push({\r\n    name: targetRouteName,\r\n    params: {\r\n      portalSlug: slug,\r\n      locale: defaultLocale,\r\n    },\r\n  });\r\n};\r\n\r\nconst openCreatePortalDialog = () => {\r\n  emit('createPortal');\r\n  emit('close');\r\n};\r\n\r\nconst onClickPreviewPortal = () => {\r\n  window.open(portalLink.value, '_blank');\r\n};\r\n\r\nconst redirectToPortalHomePage = () => {\r\n  router.push({\r\n    name: 'portals_index',\r\n    params: {\r\n      navigationPath: DEFAULT_ROUTE,\r\n    },\r\n  });\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div\r\n    class=\"pt-5 pb-3 bg-n-alpha-3 backdrop-blur-[100px] outline outline-n-container outline-1 z-50 absolute w-[27.5rem] rounded-xl shadow-md flex flex-col gap-4\"\r\n  >\r\n    <div\r\n      class=\"flex items-center justify-between gap-4 px-6 pb-3 border-b border-n-alpha-2\"\r\n    >\r\n      <div class=\"flex flex-col gap-1\">\r\n        <div class=\"flex items-center gap-2\">\r\n          <h2\r\n            class=\"text-base font-medium cursor-pointer text-slate-900 dark:text-slate-50 w-fit hover:underline\"\r\n            @click=\"redirectToPortalHomePage\"\r\n          >\r\n            {{ t('HELP_CENTER.PORTAL_SWITCHER.PORTALS') }}\r\n          </h2>\r\n          <Button\r\n            icon=\"i-lucide-arrow-up-right\"\r\n            variant=\"ghost\"\r\n            color=\"slate\"\r\n            icon-lib=\"lucide\"\r\n            size=\"sm\"\r\n            class=\"!w-6 !h-6 hover:bg-n-slate-2 text-n-slate-11 !p-0.5 rounded-md\"\r\n            @click=\"onClickPreviewPortal\"\r\n          />\r\n        </div>\r\n        <p class=\"text-sm text-slate-600 dark:text-slate-300\">\r\n          {{ t('HELP_CENTER.PORTAL_SWITCHER.CREATE_PORTAL') }}\r\n        </p>\r\n      </div>\r\n      <Button\r\n        :label=\"t('HELP_CENTER.PORTAL_SWITCHER.NEW_PORTAL')\"\r\n        color=\"slate\"\r\n        icon=\"i-lucide-plus\"\r\n        size=\"sm\"\r\n        class=\"!bg-n-alpha-2 hover:!bg-n-alpha-3\"\r\n        @click=\"openCreatePortalDialog\"\r\n      />\r\n    </div>\r\n    <div v-if=\"portals.length > 0\" class=\"flex flex-col gap-2 px-4\">\r\n      <Button\r\n        v-for=\"(portal, index) in portals\"\r\n        :key=\"index\"\r\n        :label=\"portal.name\"\r\n        variant=\"ghost\"\r\n        color=\"slate\"\r\n        trailing-icon\r\n        :icon=\"isPortalActive(portal) ? 'i-lucide-check' : ''\"\r\n        class=\"!justify-end !px-2 !py-2 hover:!bg-n-alpha-2 [&>.i-lucide-check]:text-n-teal-10 h-9\"\r\n        size=\"sm\"\r\n        @click=\"handlePortalChange(portal)\"\r\n      >\r\n        <div v-if=\"portal.custom_domain\" class=\"flex items-center gap-1\">\r\n          <span class=\"i-lucide-link size-3\" />\r\n          <span class=\"text-sm truncate text-n-slate-11\">\r\n            {{ portal.custom_domain || '' }}\r\n          </span>\r\n        </div>\r\n        <span class=\"text-sm font-medium truncate text-n-slate-12\">\r\n          {{ portal.name || '' }}\r\n        </span>\r\n        <Avatar\r\n          v-if=\"portal\"\r\n          :name=\"portal.name\"\r\n          :src=\"getPortalThumbnailSrc(portal)\"\r\n          :size=\"20\"\r\n          icon-name=\"i-lucide-building-2\"\r\n          rounded-full\r\n        />\r\n      </Button>\r\n    </div>\r\n  </div>\r\n</template>\r\n","<script setup>\r\nimport { ref, computed } from 'vue';\r\nimport { OnClickOutside } from '@vueuse/components';\r\nimport { useRoute } from 'vue-router';\r\nimport { useMapGetter } from 'dashboard/composables/store.js';\r\n\r\nimport PaginationFooter from 'dashboard/components-next/pagination/PaginationFooter.vue';\r\nimport Button from 'dashboard/components-next/button/Button.vue';\r\nimport PortalSwitcher from 'dashboard/components-next/HelpCenter/PortalSwitcher/PortalSwitcher.vue';\r\nimport CreatePortalDialog from 'dashboard/components-next/HelpCenter/PortalSwitcher/CreatePortalDialog.vue';\r\n\r\ndefineProps({\r\n  currentPage: {\r\n    type: Number,\r\n    default: 1,\r\n  },\r\n  totalItems: {\r\n    type: Number,\r\n    default: 100,\r\n  },\r\n  itemsPerPage: {\r\n    type: Number,\r\n    default: 25,\r\n  },\r\n  showHeaderTitle: {\r\n    type: Boolean,\r\n    default: true,\r\n  },\r\n  showPaginationFooter: {\r\n    type: Boolean,\r\n    default: true,\r\n  },\r\n});\r\n\r\nconst emit = defineEmits(['update:currentPage']);\r\n\r\nconst route = useRoute();\r\n\r\nconst createPortalDialogRef = ref(null);\r\n\r\nconst showPortalSwitcher = ref(false);\r\n\r\nconst portals = useMapGetter('portals/allPortals');\r\n\r\nconst currentPortalSlug = computed(() => route.params.portalSlug);\r\n\r\nconst activePortalName = computed(() => {\r\n  return portals.value?.find(portal => portal.slug === currentPortalSlug.value)\r\n    ?.name;\r\n});\r\n\r\nconst updateCurrentPage = page => {\r\n  emit('update:currentPage', page);\r\n};\r\nconst togglePortalSwitcher = () => {\r\n  showPortalSwitcher.value = !showPortalSwitcher.value;\r\n};\r\n</script>\r\n\r\n<template>\r\n  <section class=\"flex flex-col w-full h-full overflow-hidden bg-n-background\">\r\n    <header class=\"sticky top-0 z-10 px-6 pb-3 lg:px-0\">\r\n      <div class=\"w-full max-w-[60rem] mx-auto lg:px-6\">\r\n        <div\r\n          v-if=\"showHeaderTitle\"\r\n          class=\"flex items-center justify-start h-20 gap-2\"\r\n        >\r\n          <span\r\n            v-if=\"activePortalName\"\r\n            class=\"text-xl font-medium text-n-slate-12\"\r\n          >\r\n            {{ activePortalName }}\r\n          </span>\r\n          <div v-if=\"activePortalName\" class=\"relative group\">\r\n            <OnClickOutside @trigger=\"showPortalSwitcher = false\">\r\n              <Button\r\n                icon=\"i-lucide-chevron-down\"\r\n                variant=\"ghost\"\r\n                color=\"slate\"\r\n                size=\"xs\"\r\n                class=\"rounded-md group-hover:bg-n-slate-3 hover:bg-n-slate-3\"\r\n                @click=\"togglePortalSwitcher\"\r\n              />\r\n\r\n              <PortalSwitcher\r\n                v-if=\"showPortalSwitcher\"\r\n                class=\"absolute ltr:left-0 rtl:right-0 top-9\"\r\n                @close=\"showPortalSwitcher = false\"\r\n                @create-portal=\"createPortalDialogRef.dialogRef.open()\"\r\n              />\r\n            </OnClickOutside>\r\n            <CreatePortalDialog ref=\"createPortalDialogRef\" />\r\n          </div>\r\n        </div>\r\n        <slot name=\"header-actions\" />\r\n      </div>\r\n    </header>\r\n    <main class=\"flex-1 px-6 overflow-y-auto lg:px-0\">\r\n      <div class=\"w-full max-w-[60rem] mx-auto py-3 lg:px-6\">\r\n        <slot name=\"content\" />\r\n      </div>\r\n    </main>\r\n    <footer v-if=\"showPaginationFooter\" class=\"sticky bottom-0 z-10 px-4 pb-4\">\r\n      <PaginationFooter\r\n        :current-page=\"currentPage\"\r\n        :total-items=\"totalItems\"\r\n        :items-per-page=\"itemsPerPage\"\r\n        @update:current-page=\"updateCurrentPage\"\r\n      />\r\n    </footer>\r\n    <!-- Do not remove this slot. It can be used to add dialogs. -->\r\n    <slot />\r\n  </section>\r\n</template>\r\n"],"names":["DEFAULT_ROUTE","CATEGORY_ROUTE","emit","__emit","t","useI18n","route","useRoute","router","useRouter","store","useStore","CATEGORY_SUB_ROUTES","portals","useMapGetter","currentPortalSlug","computed","portalLink","buildPortalURL","isPortalActive","portal","getPortalThumbnailSrc","_a","fetchPortalAndItsCategories","slug","locale","selectedPortalParam","handlePortalChange","defaultLocale","targetRouteName","openCreatePortalDialog","onClickPreviewPortal","redirectToPortalHomePage","createPortalDialogRef","ref","showPortalSwitcher","activePortalName","_b","updateCurrentPage","page","togglePortalSwitcher"],"mappings":"m9BAiBMA,EAAgB,yBAChBC,GAAiB,wGARvB,MAAMC,EAAOC,EAEP,CAAE,EAAAC,CAAC,EAAKC,IACRC,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAClBC,EAAQC,EAAQ,EAIhBC,EAAsB,CAC1B,oCACA,kCACF,EAEMC,EAAUC,EAAa,oBAAoB,EAE3CC,EAAoBC,EAAS,IAAMV,EAAM,OAAO,UAAU,EAE1DW,EAAaD,EAAS,IACnBE,EAAeH,EAAkB,KAAK,CAC9C,EAEKI,EAAiBC,GACdA,EAAO,OAASL,EAAkB,MAGrCM,EAAwBD,GAAU,OACtC,QAAOE,EAAAF,GAAA,YAAAA,EAAQ,OAAR,YAAAE,EAAc,WAAY,EACnC,EAEMC,EAA8B,MAAOC,EAAMC,IAAW,CAC1D,MAAMf,EAAM,SAAS,uBAAwB,EAAI,EACjD,MAAMA,EAAM,SAAS,eAAe,EACpC,MAAMgB,EAAsB,CAC1B,WAAYF,EACZ,OAAAC,CACJ,EACE,MAAMf,EAAM,SAAS,eAAgBgB,CAAmB,EACxD,MAAMhB,EAAM,SAAS,mBAAoBgB,CAAmB,EAC5D,MAAMhB,EAAM,SAAS,YAAY,EACjC,MAAMA,EAAM,SAAS,uBAAwB,EAAK,CACpD,EAEMiB,EAAqB,MAAMP,GAAU,CACzC,GAAID,EAAeC,CAAM,EAAG,OAC5B,KAAM,CACJ,KAAAI,EACA,KAAM,CAAE,eAAgBI,CAAe,CACxC,EAAGR,EACJlB,EAAK,OAAO,EACZ,MAAMqB,EAA4BC,EAAMI,CAAa,EACrD,MAAMC,EAAkBjB,EAAoB,SAASN,EAAM,IAAI,EAC3DL,GACAK,EAAM,MAAQN,EAClBQ,EAAO,KAAK,CACV,KAAMqB,EACN,OAAQ,CACN,WAAYL,EACZ,OAAQI,CACT,CACL,CAAG,CACH,EAEME,EAAyB,IAAM,CACnC5B,EAAK,cAAc,EACnBA,EAAK,OAAO,CACd,EAEM6B,EAAuB,IAAM,CACjC,OAAO,KAAKd,EAAW,MAAO,QAAQ,CACxC,EAEMe,EAA2B,IAAM,CACrCxB,EAAO,KAAK,CACV,KAAM,gBACN,OAAQ,CACN,eAAgBR,CACjB,CACL,CAAG,CACH,+iECvDA,MAAME,EAAOC,EAEPG,EAAQC,EAAQ,EAEhB0B,EAAwBC,EAAI,IAAI,EAEhCC,EAAqBD,EAAI,EAAK,EAE9BrB,EAAUC,EAAa,oBAAoB,EAE3CC,EAAoBC,EAAS,IAAMV,EAAM,OAAO,UAAU,EAE1D8B,EAAmBpB,EAAS,IAAM,SACtC,OAAOqB,GAAAf,EAAAT,EAAQ,QAAR,YAAAS,EAAe,KAAKF,GAAUA,EAAO,OAASL,EAAkB,SAAhE,YAAAsB,EACH,IACN,CAAC,EAEKC,EAAoBC,GAAQ,CAChCrC,EAAK,qBAAsBqC,CAAI,CACjC,EACMC,EAAuB,IAAM,CACjCL,EAAmB,MAAQ,CAACA,EAAmB,KACjD"}
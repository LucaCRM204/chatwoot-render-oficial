{"version":3,"file":"PortalsArticlesNewPage-1g9Na3Nu.js","sources":["../../../app/javascript/dashboard/routes/dashboard/helpcenter/pages/PortalsArticlesNewPage.vue"],"sourcesContent":["<script setup>\r\nimport { ref, computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { useI18n } from 'vue-i18n';\r\nimport { useAlert, useTrack } from 'dashboard/composables';\r\nimport { useStore, useMapGetter } from 'dashboard/composables/store';\r\nimport { PORTALS_EVENTS } from 'dashboard/helper/AnalyticsHelper/events';\r\n\r\nimport ArticleEditor from 'dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditor.vue';\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst store = useStore();\r\nconst { t } = useI18n();\r\n\r\nconst { portalSlug } = route.params;\r\n\r\nconst selectedAuthorId = ref(null);\r\nconst selectedCategoryId = ref(null);\r\n\r\nconst currentUserId = useMapGetter('getCurrentUserID');\r\nconst categories = useMapGetter('categories/allCategories');\r\n\r\nconst categoryId = computed(() => categories.value[0]?.id || null);\r\n\r\nconst article = ref({});\r\nconst isUpdating = ref(false);\r\nconst isSaved = ref(false);\r\n\r\nconst setAuthorId = authorId => {\r\n  selectedAuthorId.value = authorId;\r\n};\r\n\r\nconst setCategoryId = newCategoryId => {\r\n  selectedCategoryId.value = newCategoryId;\r\n};\r\n\r\nconst createNewArticle = async ({ title, content }) => {\r\n  if (title) article.value.title = title;\r\n  if (content) article.value.content = content;\r\n\r\n  if (!article.value.title || !article.value.content) return;\r\n\r\n  isUpdating.value = true;\r\n  try {\r\n    const { locale } = route.params;\r\n    const articleId = await store.dispatch('articles/create', {\r\n      portalSlug,\r\n      content: article.value.content,\r\n      title: article.value.title,\r\n      locale: locale,\r\n      authorId: selectedAuthorId.value || currentUserId.value,\r\n      categoryId: selectedCategoryId.value || categoryId.value,\r\n    });\r\n\r\n    useTrack(PORTALS_EVENTS.CREATE_ARTICLE, { locale });\r\n\r\n    router.replace({\r\n      name: 'portals_articles_edit',\r\n      params: {\r\n        articleSlug: articleId,\r\n        portalSlug,\r\n        locale,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    const errorMessage =\r\n      error?.message || t('HELP_CENTER.EDIT_ARTICLE_PAGE.API.ERROR');\r\n    useAlert(errorMessage);\r\n  } finally {\r\n    isUpdating.value = false;\r\n  }\r\n};\r\n\r\nconst goBackToArticles = () => {\r\n  const { tab, categorySlug, locale } = route.params;\r\n  router.push({\r\n    name: 'portals_articles_index',\r\n    params: { tab, categorySlug, locale },\r\n  });\r\n};\r\n</script>\r\n\r\n<template>\r\n  <ArticleEditor\r\n    :article=\"article\"\r\n    :is-updating=\"isUpdating\"\r\n    :is-saved=\"isSaved\"\r\n    @save-article=\"createNewArticle\"\r\n    @go-back=\"goBackToArticles\"\r\n    @set-author=\"setAuthorId\"\r\n    @set-category=\"setCategoryId\"\r\n  />\r\n</template>\r\n"],"names":["route","useRoute","router","useRouter","store","useStore","t","useI18n","portalSlug","selectedAuthorId","ref","selectedCategoryId","currentUserId","useMapGetter","categories","categoryId","computed","_a","article","isUpdating","isSaved","setAuthorId","authorId","setCategoryId","newCategoryId","createNewArticle","title","content","locale","articleId","useTrack","PORTALS_EVENTS","error","errorMessage","useAlert","goBackToArticles","tab","categorySlug"],"mappings":"s/BAUA,MAAMA,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAClBC,EAAQC,EAAQ,EAChB,CAAE,EAAAC,CAAC,EAAKC,IAER,CAAE,WAAAC,CAAU,EAAKR,EAAM,OAEvBS,EAAmBC,EAAI,IAAI,EAC3BC,EAAqBD,EAAI,IAAI,EAE7BE,EAAgBC,EAAa,kBAAkB,EAC/CC,EAAaD,EAAa,0BAA0B,EAEpDE,EAAaC,EAAS,IAAA,OAAM,QAAAC,EAAAH,EAAW,MAAM,CAAC,IAAlB,YAAAG,EAAqB,KAAM,KAAI,EAE3DC,EAAUR,EAAI,CAAA,CAAE,EAChBS,EAAaT,EAAI,EAAK,EACtBU,EAAUV,EAAI,EAAK,EAEnBW,EAAcC,GAAY,CAC9Bb,EAAiB,MAAQa,CAC3B,EAEMC,EAAgBC,GAAiB,CACrCb,EAAmB,MAAQa,CAC7B,EAEMC,EAAmB,MAAO,CAAE,MAAAC,EAAO,QAAAC,KAAc,CAIrD,GAHID,IAAOR,EAAQ,MAAM,MAAQQ,GAC7BC,IAAST,EAAQ,MAAM,QAAUS,GAEjC,GAACT,EAAQ,MAAM,OAAS,CAACA,EAAQ,MAAM,SAE3C,CAAAC,EAAW,MAAQ,GACnB,GAAI,CACF,KAAM,CAAE,OAAAS,CAAM,EAAK5B,EAAM,OACnB6B,EAAY,MAAMzB,EAAM,SAAS,kBAAmB,CACxD,WAAAI,EACA,QAASU,EAAQ,MAAM,QACvB,MAAOA,EAAQ,MAAM,MACrB,OAAQU,EACR,SAAUnB,EAAiB,OAASG,EAAc,MAClD,WAAYD,EAAmB,OAASI,EAAW,KACzD,CAAK,EAEDe,EAASC,EAAe,eAAgB,CAAE,OAAAH,CAAQ,CAAA,EAElD1B,EAAO,QAAQ,CACb,KAAM,wBACN,OAAQ,CACN,YAAa2B,EACb,WAAArB,EACA,OAAAoB,CACD,CACP,CAAK,CACF,OAAQI,EAAO,CACd,MAAMC,GACJD,GAAA,YAAAA,EAAO,UAAW1B,EAAE,yCAAyC,EAC/D4B,EAASD,CAAY,CACzB,QAAY,CACRd,EAAW,MAAQ,EACpB,EACH,EAEMgB,EAAmB,IAAM,CAC7B,KAAM,CAAE,IAAAC,EAAK,aAAAC,EAAc,OAAAT,CAAM,EAAK5B,EAAM,OAC5CE,EAAO,KAAK,CACV,KAAM,yBACN,OAAQ,CAAE,IAAAkC,EAAK,aAAAC,EAAc,OAAAT,CAAQ,CACzC,CAAG,CACH"}